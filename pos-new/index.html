<!DOCTYPE html>
<html>
<head>

<style>

body {
    background-color: rgb(227, 227, 227);
    font-family: "Verdana", sans-serif;
    color: #565656;
}

table {
    border-spacing: 5px;
    table-layout: fixed;
    width: 100%;
}

button {
    border: 0px solid white;
    border-radius: 5px;
}

#checkout {
    background-color: white;
    border: 0px solid white;
    border-radius: 5px;
}

#food-button {
    background-color: white;
    color: #565656;
    font-size: 13px;
    text-align: center;
    width: 100%;
    height: 100px;
    border: 0px solid rgb(255, 255, 255);
    border-radius: 5px;

}

#food-button:hover {
    background-color: rgb(212, 212, 212);
}

#order-num-p {
    margin-top: -100px;
}

#bill-wrapper {
    background-color: white;
    height: 300px;
}

#bill-table-wrapper {
    height: 270px;
    overflow: auto;
}

#bill-header-td {
    border-bottom: 2px solid black;
}

/* #menu-button {
    background-color:rgb(108, 181, 220);
    width: 100%;
    height: 120px;
}

#menu-button:hover {
    background-color: rgb(86, 154, 191);
} */

#pay-button {
    background-color:rgb(51, 168, 77);
    width: 100%;
    height: 40px;
    color: white;
    box-shadow: 5x 10px black;
}

#pay-button:hover {
    background-color: rgb(18, 134, 43);
}

#bill-menu-button {
    background-color: rgb(21, 141, 202);
    color: white;
    width: 100%;
    height: 40px;
}

#bill-menu-button:hover {
    background-color: rgb(18, 110, 157);
}

#bill-item-selector {
    width: 100%;
    background-color: rgb(21, 141, 202);
    color: white;
    height: 50px;

}

#lightbox-wrapper {
    width: 100vw;
    height: 100vh;
    background-color: rgba(148, 148, 148, .9);
    z-index: 2;
    position: absolute;
    top: 0;
    left: 0;
}

#lightbox {
    width: 350px;
    height: 250px;
    background-color: white;
    z-index: 2;
    position: absolute;
    top: 50%;
    left: 50%;
}

#pos-buttons {
    z-index: -1;
}

/* Side navigation animation */
.sidenav {
  height: 100%;
  width: 0;
  position: fixed;
  z-index: 1;
  top: 0;
  left: 0;
  background-color: rgb(21, 141, 202);
  overflow-x: hidden;
  transition: 0.5s;
  padding-top: 60px;
}

.sidenav a {
  padding: 8px 8px 8px 32px;
  text-decoration: none;
  font-size: 15px;
  color: white;
  display: block;
  transition: 0.3s;
}

.sidenav a:hover {
  color: #f1f1f1;
}

.sidenav .closebtn {
  position: absolute;
  top: 0;
  right: 25px;
  font-size: 36px;
  margin-left: 50px;
}

#main {
  transition: margin-left .5s;
  padding: 5px;
}

@media screen and (max-height: 450px) {
  .sidenav {padding-top: 15px;}
  .sidenav a {font-size: 18px;}
}
/* ------------------------- */ 

/* Loading animation */
.loader {
  border: 10px solid #f3f3f3;
  border-radius: 50%;
  border-top: 10px solid #3498db;
  width: 30px;
  height: 30px;
  -webkit-animation: spin 2s linear infinite; /* Safari */
  animation: spin 2s linear infinite;
}

/* Safari */
@-webkit-keyframes spin {
  0% { -webkit-transform: rotate(0deg); }
  100% { -webkit-transform: rotate(360deg); }
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}
/* ----------------- */
</style>

</head>
<body>
    

<div style="width: 100vw; height: 100vh;" id="main">
    <h1 style="text-align: center; font-size: small;">Point of Sale System v2</h1>
    <p style="font-size: 10px; color: gray; text-align: center;">
    <i>Created by <a href="https://who/janinebariuan/"
                     style="color: gray; text-decoration: none;">janinebariuan@</a></i></p>

    
    <!-- Settings Button -->
    <span style="font-size:15px;cursor:pointer" onclick="openNav()">&#9776; Settings</span>

    <div style="width: 100vw; height: 100vh; display: table">
        
        <!-- Items Cell -->
        <div style="width: 70%; display: table-cell">
            <div style="display: table;">
                <!-- Products -->
                <div style=" width: 100%; height: 80%; display: table-row;">
                    <table>
                        <tr>
                            <td id="food-td">
                                <button id="food-button"
                                    type="button"
                                    value="Hamburger"
                                    onClick="addToBill(this.value)">
                                        <img src="img/hamburger.png" height="40%">
                                        <br>Hamburger</button>
                            </td>
                            <td id="food-td">
                                <button id="food-button"
                                    type="button"
                                    value="Cheeseburger"
                                    onClick="addToBill(this.value)">
                                        <img src="img/cheeseburger.png" height="40%">
                                        <br>Cheeseburger</button>
                            </td>
                            <td id="food-td">
                                <button id="food-button"
                                    type="button"
                                    value="Hotdog"
                                    onClick="addToBill(this.value)">
                                        <img src="img/hotdog.png" height="40%">
                                        <br>Hotdog</button>
                            </td>
                            <td id="food-td">
                                <button id="food-button"
                                    type="button"
                                    value="Fries"
                                    onClick="addToBill(this.value)">
                                        <img src="img/fries.png" height="50%">
                                        <br>Fries</button>
                            </td>
                        </tr>
                        <tr>
                            <td id="food-td">
                                <button id="food-button"
                                    type="button"
                                    value="Coke"
                                    onClick="addToBill(this.value)">
                                        <img src="img/coke.png" height="50%">
                                        <br>Coke</button>
                            </td>
                            <td id="food-td">
                                <button id="food-button"
                                    type="button"
                                    value="Pepsi"
                                    onClick="addToBill(this.value)">
                                        <img src="img/pepsi.png" height="50%">
                                        <br>Pepsi</button>
                            </td>
                            <td id="food-td">
                                <button id="food-button"
                                    type="button"
                                    value="Dr. Pepper"
                                    onClick="addToBill(this.value)">
                                        <img src="img/drpepper.png" height="50%">
                                        <br>Dr. Pepper</button>
                            </td>
                            <td id="food-td">
                                <button id="food-button"
                                    type="button"
                                    value="Juice"
                                    onClick="addToBill(this.value)">
                                        <img src="img/juice.png" height="30%">
                                        <br>Juice</button>
                            </td>
                        </tr>
                        <tr>
                            <td id="food-td">
                                <button id="food-button"
                                    type="button"
                                    value="Cookie"
                                    onClick="addToBill(this.value)">
                                        <img src="img/cookie.png" height="50%">
                                        <br>Cookie</button>
                            </td>
                            <td id="food-td">
                                <button id="food-button"
                                    type="button"
                                    value="Ice Cream"
                                    onClick="addToBill(this.value)">
                                        <img src="img/icecream.png" height="50%">
                                        <br>Ice Cream</button>
                            </td>
                            <td id="food-td">
                                <button id="food-button"
                                    type="button"
                                    value="Brownie"
                                    onClick="addToBill(this.value)">
                                        <img src="img/brownie.png" height="30%">
                                        <br>Brownie</button>
                            </td>
                            <td id="food-td">
                                <button id="food-button"
                                    type="button"
                                    value="Candy"
                                    onClick="addToBill(this.value)">
                                        <img src="img/candy.png" height="50%">
                                        <br>Candy</button>
                            </td>
                        </tr>
                        <tr>
                            <td id="food-td">
                                <button id="food-button"
                                    type="button"
                                    value="Ketchup"
                                    onClick="addToBill(this.value)">
                                        <img src="img/ketchup.png" height="50%">
                                        <br>Ketchup</button>
                            </td>
                            <td id="food-td">
                                <button id="food-button"
                                    type="button"
                                    value="Mustard"
                                    onClick="addToBill(this.value)">
                                        <img src="img/mustard.png" height="50%">
                                        <br>Mustard</button>
                            </td>
                            <td id="food-td">
                                <button id="food-button"
                                    type="button"
                                    value="Mayonnaise"
                                    onClick="addToBill(this.value)">
                                        <img src="img/mayo.png" height="50%">    
                                        <br>Mayonnaise</button>
                            </td>
                            <td id="food-td">
                                <button id="food-button"
                                    type="button"
                                    value="Ranch"
                                    onClick="addToBill(this.value)">
                                        <img src="img/ranch.png" height="50%">    
                                        <br>Ranch</button>
                            </td>
                        </tr>
                    </table>
                </div>

                <!-- Edit Bill -->
                <div style="width: 100%; height: 20%; display: table-row;">
                    <table>
                        <tr>
                            <td>
                                <button id="bill-menu-button"
                                        onclick="clearBill()">Clear All Items</button>
                            </td>
                            <td>
                                <button id="bill-menu-button"
                                        onclick="newOrder()">New Order</button>
                            </td>
                        </tr>
                    </table>

                </div>
            </div>
        </div>

        <div id="menu" style="width: 3%; height: 100%; display: table-cell"></div>

        <!-- Checkout Cell -->
        <div id="checkout" style="width: 27%; height: 100%; display: table-cell; padding: 30px;">
            <div>
                <p id="order-num-p"
                    style="background-color: white;"><b>Order #1</b></p>
            </div>
            <div id="bill-wrapper">
                <div id="bill-table-wrapper">
                    <table id="bill-table">
                    </table>
                </div>
                <div style="border-top: 1px solid black">
                    <table id="bill-total-table">
                        <tr>
                            <td style="width: 70%;">Total:</td>
                            <td id="bill-total-td" style="width: 30%;"></td>
                        </tr>
                    </table>
                </div>
            </div>

            <!-- Process Bill -->
            <div>
                <table>
                    <tr>
                        <td>
                            <button id="pay-button"
                                    type="button"
                                    value="up"
                                    onclick="togglePaymentLightbox()">PAY</button>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <button id="bill-item-selector" 
                                    type="button"
                                    onclick="toggleReceiptLightbox()">Print Check</button>
                        </td>
                    </tr>
                </table>
            </div>
            <footer>
                <p style="font-size: 10px; color: gray;"
                ><i>Created by <a href="https://who/janinebariuan/" style="color: gray; text-decoration: none;">janinebariuan@</a></i></p>
            </footer>
        </div>

    </div>
</div>

<!-- Side Menu Content -->
<div id="mySidenav" class="sidenav">
    <a href="javascript:void(0)" class="closebtn" onclick="closeNav()">&times;</a>
    <a href="#" onclick="">Edit Inventory</a>
    <a href="#" onclick="">View Previous Orders</a>
  </div>

<!-- Processing payment lightbox -->
<div id="lightbox-wrapper" style="display: none;">
    <div id="lightbox" style="display: none;">
        <table>
            <tr>
            <td><div class="loader"></div></td>
            <td><p id="lightbox-p"></p>
                <button
                    onclick="togglePaymentLightbox()">Cancel</button>
            </td>
            </tr>
        </table>
    </div>
</div>

<script>

    var orderNum = 1;
    var totalPrice = 0;

    const foods = ["Hamburger", "Cheeseburger", "Hotdog", "Fries"];
    const drinks = ["Coke", "Pepsi", "Dr. Pepper", "Juice"];
    const snacks = ["Cookie", "Ice Cream", "Brownie", "Candy"];
    const condiments = ["Ketchup", "Mustard", "Mayonnaise", "Ranch"];
    var prices = {
        "foods": 5,
        "drinks": 2.5,
        "snacks": 3,
        "condiments": 0.5,
    }

    function addToBill(itemName) {
        // Find a <table> element with id="bill":
        var table = document.getElementById("bill-table");
    
        // Create an empty <tr> element and add it to the end position of the table:
        var row = table.insertRow();
    
        // Insert new cells (<td> elements) at the 1st and 2nd position of the "new" <tr> element:
        var item = row.insertCell();
        var price = row.insertCell();
        var edit = row.insertCell();
    
        // Add item and price to bill:
        item.innerHTML = itemName;
        var itemPrice = getItemPrice(itemName);
        price.innerHTML = "$" + formatPrice(itemPrice);

        edit.innerHTML = `<button 
                            value="Delete"
                            onclick="removeBillItem(this)"  
                            style="background-color: #ffb7b7; color: red;">x</button>`;

        item.style.width = "50%";
        price.style.width = "30%";
        edit.style.width = "20%";

        addTotal(itemPrice);
    }

    function addTotal(itemPrice) {
        // Get <td> holding total price
        totalPrice += itemPrice;
        document.getElementById("bill-total-td").innerHTML = "$" + formatPrice(totalPrice);
    } 

    function clearBill() {
        var billTable = document.getElementById("bill-table");
        var numRows = billTable.rows.length;
        for (let row = numRows-1; row > -1; row--){
            console.log(row);
            billTable.deleteRow(row);
            console.log(numRows);
        }

        // Reset bill total
        totalPrice = 0;
        document.getElementById("bill-total-td").innerHTML = "";

    }

    function updateOrder() {
        orderNum++;
        document.getElementById("order-num-p").innerHTML = "<b> Order #" + orderNum + "</b>";
    }

    function newOrder() {
        clearBill();
        updateOrder();

    }

    var currentBillItemIndex = 0;

    function selectBillItem(direction) {

        var billTable = document.getElementById("bill-table");
        var numRows = billTable.rows.length;

        // Choose correct item
        if (direction == "down" && currentBillItemIndex < numRows-1){ 
            currentBillItemIndex++;
            prevBillItemIndex = currentBillItemIndex-1;
        }
        else if (direction == "up" && currentBillItemIndex > 1){
            currentBillItemIndex--;
            prevBillItemIndex = currentBillItemIndex+1;
        }
       
        console.log("currentRow: " + currentBillItemIndex);
        console.log("prevRow: " + prevBillItemIndex);

        // Highlight selected row
        var itemRow = document.getElementById("bill-table").rows[currentBillItemIndex];
        itemRow.style.backgroundColor = "black";
        itemRow.style.color = "white";
        
        // Unhighlight previously selected row 
        var prevItemRow = document.getElementById("bill-table").rows[prevBillItemIndex];
        prevItemRow.style.backgroundColor = "white";
        prevItemRow.style.color = "black";

    }

    function restartSelection() {
        
        // Get currently selected item
        var itemRow = document.getElementById("bill-table").rows[currentBillItemIndex];

        // Unhiglight current item
        itemRow.style.backgroundColor = "white";
        itemRow.style.color = "black";

        // reset currentBillItemIndex
        currentBillItemIndex = 0;


    }

    function removeBillItem(r) {

        // Get item name
        currentBillItemIndex = r.parentNode.parentNode.rowIndex;
        var itemRow = document.getElementById("bill-table").rows[currentBillItemIndex];
        console.log("item: " + itemRow.cells[0].innerText);
        var itemName = itemRow.cells[0].innerText;

        // Find item price
        var itemPrice = getItemPrice(itemName);

        // update total
        totalPrice -= itemPrice;
        document.getElementById("bill-total-td").innerHTML = "$" + formatPrice(totalPrice);
        
        // delete row from UI
        document.getElementById("bill-table").deleteRow(currentBillItemIndex);

        // reset currentBillItemIndex
        currentBillItemIndex = 0;
        
    }

    function deleteBillItem(r){
        var i = r.parentNode.parentNode.rowIndex;

        document.getElementById("bill-table").deleteRow(i);
    }

    function getItemPrice(itemName) {
        var itemPrice = 0;
        if (foods.includes(itemName)){ 
            return itemPrice = prices["foods"];
        }
        else if (drinks.includes(itemName)) {
            return itemPrice = prices["drinks"];
        }
        else if (snacks.includes(itemName)) {
            return itemPrice = prices["snacks"];
        }
        else if (condiments.includes(itemName)) {
            return itemPrice = prices["condiments"];
        }

        return itemPrice;
    }

    function formatPrice(price) {
        return price % 1 == 0 ? price.toString() + ".00" : price.toString() + "0" ;

    }

    // Side navigation 
    function openNav() {
        document.getElementById("mySidenav").style.width = "250px";
        document.getElementById("main").style.marginLeft = "250px";
    }

    function closeNav() {
    document.getElementById("mySidenav").style.width = "0";
    document.getElementById("main").style.marginLeft= "0";
    }

    // Lightboxes
    function togglePaymentLightbox() {
        var lightboxWrapper = document.getElementById("lightbox-wrapper");
        var lightbox = document.getElementById("lightbox");

        if (lightboxWrapper.style.display == "none" && lightbox.style.display == "none") {
            lightboxWrapper.style.display = "block";
            lightbox.style.display = "block";
        } else {
            lightboxWrapper.style.display = "none";
            lightbox.style.display = "none";
        }
        
        // Animate payment processing
        var lightboxText = document.getElementById("lightbox-p");
        lightboxText.innerHTML = "Payment processing...";
        // clearTimeout(timeout);
        timeout = setTimeout(function() {
            lightboxText.innerHTML = "Payment successful!";
        }, 2000);
        timeout = setTimeout(function() {
            lightboxWrapper.style.display = "none";
        lightbox.style.display = "none";
        }, 4000);

        newOrder();

    }

    function toggleReceiptLightbox() {
        var lightboxWrapper = document.getElementById("lightbox-wrapper");
        var lightbox = document.getElementById("lightbox");

        if (lightboxWrapper.style.display == "none" && lightbox.style.display == "none") {
            lightboxWrapper.style.display = "block";
            lightbox.style.display = "block";

        } else {
            lightboxWrapper.style.display = "none";
            lightbox.style.display = "none";
        }
        
        // Animate print receipt
        var lightboxText = document.getElementById("lightbox-p");
        lightboxText.innerHTML = "Printing receipt...";
        timeout = setTimeout(function() {
            lightboxWrapper.style.display = "none";
        lightbox.style.display = "none";
        }, 4000);
    }

</script>

</body>
</html>
